<?php

return [

    /*
    |--------------------------------------------------------------------------
    | Paths
    |--------------------------------------------------------------------------
    | API と Sanctum用だけ開けとく。Webは触らない。
    */
    'paths' => ['api/*', 'sanctum/csrf-cookie'],

    /*
    |--------------------------------------------------------------------------
    | Allowed Methods / Headers
    |--------------------------------------------------------------------------
    */
    'allowed_methods' => ['*'],
    'allowed_headers' => ['*'],

    /*
    |--------------------------------------------------------------------------
    | Allowed Origins
    |--------------------------------------------------------------------------
    | 本番ドメインは .env でカンマ区切り設定（例：
    | CORS_ALLOWED_ORIGINS=https://app.example.com,https://admin.example.com
    |
    | 開発中は下の patterns で localhost/127.0.0.1/LAN(192.168/10.x/172.16-31) を包括許可。
    */
    'allowed_origins' => array_filter(array_map('trim', explode(',', env('CORS_ALLOWED_ORIGINS', '')))),

    /*
    |--------------------------------------------------------------------------
    | Allowed Origin Patterns
    |--------------------------------------------------------------------------
    | ブラウザ系クライアント（Vite, Expo Web, PWA, 実機のLANアクセス）を許可。
    */
    'allowed_origins_patterns' => [
        '/^http:\/\/localhost(:\d+)?$/',
        '/^http:\/\/127\.0\.0\.1(:\d+)?$/',
        '/^https?:\/\/192\.168\.\d{1,3}\.\d{1,3}(:\d+)?$/',
        '/^https?:\/\/10\.\d{1,3}\.\d{1,3}\.\d{1,3}(:\d+)?$/',
        '/^https?:\/\/172\.(1[6-9]|2\d|3[0-1])\.\d{1,3}\.\d{1,3}(:\d+)?$/',
    ],

    /*
    |--------------------------------------------------------------------------
    | Exposed Headers / Max Age
    |--------------------------------------------------------------------------
    */
    'exposed_headers' => ['Authorization'],
    'max_age' => 86400, // 24h

    /*
    |--------------------------------------------------------------------------
    | Credentials
    |--------------------------------------------------------------------------
    | モバイル/SPAは Bearer トークン運用なので false。
    | Cookieベースでやるなら true にして SameSite/ドメインも合わせること。
    */
    'supports_credentials' => false,
];
